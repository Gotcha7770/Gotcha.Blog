---
title: "–ì—Ä–æ–∫–∞–µ–º –º–æ–Ω–∞–¥—ã"
icon: üïµÔ∏è‚Äç‚ôÇÔ∏è
date: 2022-04-15 10:06:00 +0300
tags: [–ø–µ—Ä–µ–≤–æ–¥, dev, F#]
---

_–ü—Ä–∏–º. –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞: –°–∞–º—ã–π —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± –æ–±—ä—è—Å–Ω–∏—Ç—å –º–æ–Ω–∞–¥—É - –∑–∞–π—Ç–∏ —á–µ—Ä–µ–∑ —Ç–µ–æ—Ä–∏—é –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –ó–Ω–∞—Ç—å, —á—Ç–æ –º–æ–Ω–∞–¥–∞ - —ç—Ç–æ –º–æ–Ω–æ–∏–¥ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —ç–Ω–¥–æ—Ñ—É–Ω–∫—Ç–æ—Ä–æ–≤ –∏ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ –∏ –ø–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ–±—â–µ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è, –Ω–æ —Å–ª–∞–±–æ –ø–æ–º–æ–≥–∞–µ—Ç –≤ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–º —Å–º—ã—Å–ª–µ. –í—Ç–æ—Ä–æ–π, —Ä–∞–≤–Ω—ã–π –ø–æ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏ –ø—Ä–∏–µ–º - –ø—Ä–∏–±–µ–≥–Ω—É—Ç—å –∫ –ø–æ–º–æ—â–∏ –æ–±—Ä–∞–∑–æ–≤, –∏ –≤–æ—Ç –º—ã —É–∂–µ —Å–∫–ª–∞–¥—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –≤ –∫–æ—Ä–æ–±–æ—á–∫–∏ –∏ –¥–æ—Å—Ç–∞–µ–º –∏—Ö –æ—Ç—Ç—É–¥–∞ (–∏–ª–∏, –≤–æ–æ–±—â–µ –∫–æ—à–º–∞—Ä, –∫–∞—Ç–∏–º—Å—è –ø–æ –∂–µ–ª–µ–∑–Ω–æ–π –¥–æ—Ä–æ–≥–µ). –ù–µ —Å–ø–æ—Ä—é, –æ–±—Ä–∞–∑—ã - —Ö–æ—Ä–æ—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –Ω–∞ —è–≤–ª–µ–Ω–∏–µ, –Ω–æ —Ç—É—Ç –º—ã —Ä–∞–≤–Ω–æ —É–¥–∞–ª–∏–ª–∏—Å—å –∏ –æ—Ç —Ç–µ–æ—Ä–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –∏ –æ—Ç –ø—Ä–∞–∫—Ç–∏–∫–∏. –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ–¥ —Ç–∞–∫–æ–≥–æ —Ä–æ–¥–∞ —Å—Ç–∞—Ç—å—è–º–∏ –Ω–µ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –ø–æ–ª–Ω–∏—Ç—å—Å—è –≤–æ–ø—Ä–æ—Å–∞–º–∏: –∞ —á—Ç–æ –Ω–∞–º —ç—Ç–æ –¥–∞–µ—Ç, –∂–∏–ª–∏ –∂–µ –±–µ–∑ –º–æ–Ω–∞–¥—ã –∫–∞–∫-—Ç–æ?_

_–ê–≤—Ç–æ—Ä, –ø–æ–¥–æ–±–Ω–æ –ª–µ–∫—Ç–æ—Ä—É –ø–æ –º–∞—Ç–µ–º–∞—Ç–∏–∫–µ, —É –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã–ª–µ—Ç–µ–ª–æ –∏–∑ –≥–æ–ª–æ–≤—ã –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ —Ç–µ–æ—Ä–µ–º—ã –∏ –æ–Ω –¥–æ–∫–∞–∑–∞–ª –µ–µ –ø—Ä—è–º–æ —É –¥–æ—Å–∫–∏, –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É—è—Å—å –Ω–∞ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ, –∫–∞–∫ –±—ã —Ö–æ—Ç–µ–ª–æ—Å—å —Ä–µ—à–∏—Ç—å –∑–∞–¥–∞—á—É, –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –ø—Ä–æ–±–∏—Ä–∞–µ—Ç—Å—è –æ—Ç –∫–æ—Ä—è–≤–æ–≥–æ –∫—É—Å–∫–∞ –∫–æ–¥–∞ –∫ –ª–∞–∫–æ–Ω–∏—á–Ω–æ–º—É._

_–î–∞–∂–µ –Ω–µ –∑–Ω–∞—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã, –º—ã –º–æ–∂–µ–º —Å–∞–º–∏ –Ω–µ—á–∞—è–Ω–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –∏—Ö, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ —É–¥–æ–±–Ω—ã –∏ –ø–æ–ª–µ–∑–Ω—ã_

–í —ç—Ç–æ–º –ø–æ—Å—Ç–µ –º—ã –ø–æ—Å—Ç–∞—Ä–∞–µ–º—Å—è —Ä–∞–∑–æ–±—Ä–∞—Ç—å—Å—è, —á—Ç–æ —Ç–∞–∫–æ–µ `–º–æ–Ω–∞–¥–∞` —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Ä—É—á–Ω–æ –ø–µ—Ä–µ–∏–∑–æ–±—Ä–µ—Ç–∞—è –µ–µ –Ω–∞ —Ä–∞–±–æ—á–µ–º –ø—Ä–∏–º–µ—Ä–µ.

## –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

–î–æ–ø—É—Å—Ç–∏–º, –º—ã –ø–∏—à–µ–º –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–∂–µ–Ω —Å–ø–∏—Å–∞—Ç—å –¥–µ–Ω—å–≥–∏ —Å –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ —É –Ω–µ–≥–æ –≤ –ø—Ä–æ—Ñ–∏–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –∫—Ä–µ–¥–∏—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞, –º—ã –º–æ–∂–µ–º —Å–ø–∏—Å–∞—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –Ω–∞–º —Å–ª–µ–¥—É–µ—Ç –ø–æ–¥–∞—Ç—å —Å–∏–≥–Ω–∞–ª –æ —Ç–æ–º, —á—Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –ø—Ä–æ–∏–∑–æ—à–ª–æ.

–ù–∞—à–∞ –º–æ–¥–µ–ª—å –¥–∞–Ω–Ω—ã—Ö –Ω–∞ F#

```F#
type CreditCard =
    { Number: string
      Expiry: string
      Cvv: string }

type User =
    { Id: UserId
      CreditCard: CreditCard option }
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –ø–æ–ª–µ `CreditCard` —É —Ç–∏–ø–∞ `User` –æ—Ç–º–µ—á–µ–Ω–æ –∫–∞–∫ `option`, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–∞—Ä—Ç–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞._

## –ù–∞—à–∞ –ø–µ—Ä–≤–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ü–æ–ø—Ä–æ–±—É–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `chargeUserCard`. –°–Ω–∞—á–∞–ª–∞ –º—ã –æ–ø—Ä–µ–¥–µ–ª–∏–º –ø–∞—Ä—É –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∑–∞–≥–ª—É—à–µ–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ —Å–ø–∏—Å–∞–Ω–∏—è —Å—Ä–µ–¥—Å—Ç–≤.

```F#
let chargeCard (amount: double) (card: CreditCard): TransactionId option =
    // —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —Å–ø–∏—Å—ã–≤–∞–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å –∫–∞—Ä—Ç—ã –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç
    // –Ω–µ–∫–∏–π Id —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —Å–ª—É—á–∞–µ —É—Å–ø–µ—Ö–∞, –∏–Ω–∞—á–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç None

let lookupUser (userId: UserId): User option =
    // —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∏—â–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–µ—Ç –∏ –Ω–µ –±—ã—Ç—å

let chargeUserCard (amount: double) (userId: UserId): TransactionId option =
    let user = lookupUser userId
    match user with
    | Some u ->
        match u.CreditCard with
        | Some cc -> chargeCard amount cc
        | None -> None
    | None -> None
```

–ì–æ—Ç–æ–≤–æ! –ù–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å –¥–æ–≤–æ–ª—å–Ω–æ –Ω–µ–æ–ø—Ä—è—Ç–Ω–æ. –î–≤–æ–π–Ω–æ–µ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –æ–±—Ä–∞–∑—Ü–æ–º –Ω–µ —Å–∞–º—ã–π —è—Å–Ω—ã–π –¥–ª—è —á—Ç–µ–Ω–∏—è –∫–æ–¥. –î–∞, –≤ —ç—Ç–æ–º –ø—Ä–æ—Å—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –º–æ–≥–ª–∏ –±—ã –æ—Å—Ç–∞–≤–∏—Ç—å –∏ —Ç–∞–∫, –Ω–æ —á—Ç–æ, –µ—Å–ª–∏ –±—ã —É –Ω–∞—Å –±—ã–ª —Ç—Ä–µ—Ç–∏–π –∏–ª–∏ —á–µ—Ç–≤–µ—Ä—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç–∏?

–ú—ã –º–æ–≥–ª–∏ –±—ã —Ä–µ—à–∏—Ç—å —ç—Ç–æ –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π, –Ω–æ –µ—Å—Ç—å –µ—â–µ –æ–¥–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –≤ –æ–±–æ–∏—Ö —Å–ª—É—á–∞—è—Ö –ø—Ä–∏ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–∏ —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º `None` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è `None`. –í –Ω–∞—à–µ–º –ø—Ä–∏–º–µ—Ä–µ —ç—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ—Å—Ç—Ä–∞—à–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ø—Ä–æ—Å—Ç–æ–µ –∏ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–≤–∞–∂–¥—ã. –ù–æ –º—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–ø–æ—Å–æ–±–Ω—ã –Ω–∞ –ª—É—á—à–µ–µ, —á–µ–º —ç—Ç–æ.

–ß–µ–≥–æ –º—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏–º, —Ç–∞–∫ —ç—Ç–æ –∏–º–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞–∑–∞—Ç—å: ¬´–ï—Å–ª–∏ –≤ –∫–∞–∫–æ–π-—Ç–æ –º–æ–º–µ–Ω—Ç –º—ã –Ω–µ –º–æ–∂–µ–º –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∏–∑-–∑–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö, —Ç–æ–≥–¥–∞ –æ—Å—Ç–∞–Ω–æ–≤–∏—Å—å –∏ –≤–µ—Ä–Ω–∏ None¬ª.

## –ù–∞—à–∞ –∂–µ–ª–∞–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ù–∞ –º–≥–Ω–æ–≤–µ–Ω–∏–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç, –∏ —É –Ω–∞—Å –Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π —Ç–∏–ø–∞ `option`. –ù–∞–∑–æ–≤–µ–º —Ç–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é `chargeUserCardSafe` –∏ –≤—ã–≥–ª—è–¥–µ—Ç—å –æ–Ω–∞ –¥–æ–ª–∂–Ω—ã –∫–∞–∫-—Ç–æ —Ç–∞–∫:

```F#
let chargeUserCardSafe (amount: double) (userId: UserId): TransactionId =
    let user = lookupUser userId
    let creditCard = user.CreditCard
    chargeCard amount creditCard
```

_–û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ–ø–µ—Ä—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ—Å—Ç–æ `TransactionId` –≤–º–µ—Å—Ç–æ `option`, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –Ω–µ –º–æ–∂–µ—Ç –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è –æ—à–∏–±–∫–æ–π._

–ë—ã–ª–æ –±—ã –∑–¥–æ—Ä–æ–≤–æ, –µ—Å–ª–∏ –±—ã –º—ã –º–æ–≥–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –≤—ã–≥–ª—è–¥—è—â–∏–π —Ç–æ—á–Ω–æ —Ç–∞–∫ –∂–µ, –¥–∞–∂–µ –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∏–Ω–æ–≥–¥–∞ –º–æ–≥—É—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å. –ß—Ç–æ–±—ã —ç—Ç–æ —Å—Ä–∞–±–æ—Ç–∞–ª–æ, –º—ã –¥–æ–ª–∂–Ω—ã –ø–æ–º–µ—Å—Ç–∏—Ç—å —á—Ç–æ-—Ç–æ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ —Å—Ç—Ä–æ—á–∫–∞–º–∏ –∫–æ–¥–∞, —á—Ç–æ–±—ã —Å–æ–≤–ø–∞–ª–∏ —Ç–∏–ø—ã –∏ —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Å–æ–µ–¥–∏–Ω–∏—Ç—å –∏—Ö.

## –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –¥–ª—è –±–æ–ª–µ–µ —á–∏—Å—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

–ö–∞–∫ —ç—Ç–æ—Ç —Å–æ–µ–¥–∏–Ω—è—é—â–∏–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å? –û–Ω –¥–æ–ª–∂–µ–Ω –∑–∞–≤–µ—Ä—à–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–µ–º —à–∞–≥–µ –º—ã –ø–æ–ª—É—á–∏–ª–∏ `None`, –≤ –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –æ–Ω –¥–æ–ª–∂–µ–Ω –∏–∑–≤–ª–µ—á—å –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `Some` –∏ –ø–µ—Ä–µ–¥–∞—Ç—å –µ–≥–æ –≤ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É. –ü–æ —Å—É—Ç–∏, —ç—Ç–æ —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Å –æ–±—Ä–∞–∑—Ü–æ–º, –æ –∫–æ—Ç–æ—Ä–æ–º –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –≤—ã—à–µ.

–ß—Ç–æ –∂, –ø–æ—Å–º–æ—Ç—Ä–∏–º, —Å–º–æ–∂–µ–º –ª–∏ –º—ã –µ–≥–æ –∏–∑–≤–ª–µ—á—å. –î–ª—è –Ω–∞—á–∞–ª–∞ –ø–µ—Ä–µ–ø–∏—à–µ–º –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –≤ –≤–∏–¥–µ –∫–æ–Ω–≤–µ–π–µ—Ä–∞, —á—Ç–æ–±—ã –ø–æ–∑–∂–µ –º—ã –º–æ–≥–ª–∏ –ª–µ–≥–∫–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –Ω–∞—à—É –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é –º–µ–∂–¥—É —à–∞–≥–∞–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è.

```F#
// –≠—Ç–∞ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω—É–∂–Ω–∞ –ª–∏—à—å –¥–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –Ω–∞–º –±—ã–ª–æ –ø—Ä–æ—â–µ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –≤—Å–µ —à–∞–≥–∏
let getCreditCard (user: User): CreditCard option =
    user.CreditCard

let chargeUserCardSafe (amount: double) (userId: UserId): TransactionId =
    userId
    |> lookupUser
    |> getCreditCard
    |> chargeCard amount
```

–í—Å–µ —á—Ç–æ –º—ã —Å–¥–µ–ª–∞–ª–∏ - –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏ –Ω–∞—à–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤ –∫–æ–Ω–≤–µ–π–µ—Ä –ø—Ä–∏ –ø–æ–º–æ—â–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞. –¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏–∏ `lookupUser` –∏ `chargeCard` –±—É–¥—É—Ç —Å–Ω–æ–≤–∞ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `option`, —ç—Ç–æ—Ç –ø—Ä–∏–º–µ—Ä –±–æ–ª—å—à–µ –Ω–µ —Å–∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è. –ü—Ä–æ–±–ª–µ–º–∞ –≤ —Ç–æ–º, —á—Ç–æ –º—ã –Ω–µ –º–æ–∂–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å

```F#
userId |> lookupUser |> getCreditCard
```

–ø–æ—Ç–æ–º—É —á—Ç–æ `lookupUser` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–∏–ø `User option`, –∞ –º—ã –ø—ã—Ç–∞–µ–º—Å—è –ø–µ—Ä–µ–¥–∞—Ç—å —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –≤—Ö–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç `User`.

–ò—Ç–∞–∫, —É –Ω–∞—Å –µ—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —ç—Ç—É –æ—à–∏–±–∫—É.

1. –ù–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Ç–∏–ø–∞ `User option -> User`, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–≤–µ—Ä–Ω–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ `option`, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–∂–Ω–æ –±—ã–ª–æ –ø–µ—Ä–µ–¥–∞—Ç—å –¥–∞–ª–µ–µ –ø–æ –∫–æ–Ω–≤–µ–π–µ—Ä—É. –û–¥–Ω–∞–∫–æ, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –∑–Ω–∞—á–µ–Ω–∏–µ `None` –º—ã —Ç–µ—Ä—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–æ–∑–º–æ–∂–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –í –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ç–æ —Ä–µ—à–∞–µ—Ç—Å—è –≤—ã–±—Ä–∞—Å—ã–≤–∞–Ω–∏–µ–º –∏—Å–∫–ª—é—á–µ–Ω–∏—è. –ù–æ, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –Ω–∞–º –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å [???], –ø–æ—ç—Ç–æ–º—É –º—ã –Ω–µ –±—É–¥–µ–º —Ç–∞–∫ –¥–µ–ª–∞—Ç—å.
2. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã –º–æ–∂–µ–º –ø–æ–º–µ–Ω—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Å –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞, —á—Ç–æ–±—ã –æ–Ω–∞ –º–æ–≥–ª–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å —Ç–∏–ø `User option`, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ `User`. –ù–∞–º –Ω—É–∂–Ω–æ —á—Ç–æ-—Ç–æ, —á—Ç–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –≤ –∫–∞—á–µ—Å—Ç–≤–µ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –µ–µ –≤ –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é.

–ú—ã –∑–Ω–∞–µ–º, —á—Ç–æ —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –¥–æ–ª–∂–Ω–∞ –∏–º–µ—Ç—å —Ç–∏–ø

```F#
(User -> CreditCard option) -> (User option -> CreditCard option)
```

## –ù–∞ –ø–æ—Ä–æ–≥–µ –æ—Ç–∫—Ä—ã—Ç–∏—è

_–ü—Ä–∏–º. –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞: –î–∞–ª–µ–µ –≤ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–º –ø–æ—Å—Ç–µ –∏–¥–µ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª–Ω–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ —Ñ–æ–∫—É—Å–∞ —Å —Ñ—É–Ω–∫—Ç–æ—Ä–æ–º. –Ø —Ä–µ—à–∏–ª –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç—É —á–∞—Å—Ç—å._

_–í–æ–∑–º–æ–∂–Ω–æ –ø—ã—Ç–ª–∏–≤—ã–π —á–∏—Ç–∞—Ç–µ–ª—å —É–∂–µ –¥–æ–≥–∞–¥–∞–ª—Å—è, –∫ —á–µ–º—É –≤–µ–¥–µ—Ç –∞–≤—Ç–æ—Ä. –ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –Ω–∞—à—É –ø—Ä–æ–±–ª–µ–º—É, –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `—Ñ—É–Ω–∫—Ç–æ—Ä` - —Ñ—É–Ω–∫—Ü–∏—é `lift`, –∏–ª–∏ –∫–∞–∫ –º—ã –µ–µ –Ω–∞–∑–≤–∞–ª–∏ - `map`. –≠—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã—Å—à–µ–≥–æ –ø–æ—Ä—è–¥–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –≤–∑—è—Ç—å —Ñ—É–Ω–∫—Ü–∏—é —Ä–∞–±–æ—Ç–∞—é—â—É—é —Å –æ–±—ã—á–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –µ–µ –∫ –∑–Ω–∞—á–µ–Ω–∏—é –æ–±–µ—Ä–Ω—É—Ç–æ–º—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∞ –ø–æ—Ç–æ–º —Å—Ç—Ä–æ–∏—Ç—å –∫–æ–º–ø–æ–∑–∏—Ü–∏—é –∏–∑ —Ç–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π. –ù–æ –µ—Å—Ç—å –æ–¥–Ω–æ –º–∞–ª–µ–Ω—å–∫–æ–µ, –Ω–æ –≤–∞–∂–Ω–æ–µ –æ—Ç–ª–∏—á–∏–µ. –ï—Å–ª–∏ –ø–æ–º–Ω–∏—Ç–µ, –≤ –ø—Ä–æ—à–ª–æ–º –ø–æ—Å—Ç–µ, –Ω–∞—à —Ñ—É–Ω–∫—Ç–æ—Ä –ø—Ä–∏–Ω–∏–º–∞–ª —Ñ—É–Ω–∫—Ü–∏—é `User -> CreditCard`, –Ω–æ —Å–µ–π—á–∞—Å —É –Ω–∞—Å –¥—Ä—É–≥–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ - `User -> CreditCard option`. –Ø —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Å—å –Ω–∞ —ç—Ç–æ–º —Ç–∞–∫ –ø–æ–¥—Ä–æ–±–Ω–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã —Ñ—É–Ω–∫—Ü–∏–π –æ—á–µ–Ω—å –≤–∞–∂–Ω—ã, –æ–Ω–∏ –≤—ã—Ä–∞–∂–∞—é—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç —Ñ—É–Ω–∫—Ü–∏–∏. –ü—Ä–∏ –ø–æ–º–æ—â–∏ —Å–∏—Å—Ç–µ–º—ã —Ç–∏–ø–æ–≤ –º—ã –º–æ–∂–µ–º —É–∫–∞–∑–∞—Ç—å, —á—Ç–æ –µ—Å—Ç—å –≤–µ—Ç–≤—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –Ω–µ —Å–º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å –∫—Ä–µ–¥–∏—Ç–Ω—É—é –∫–∞—Ä—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è._

_–§—É–Ω–∫—Ç–æ—Ä —Ç—Ä–∞–∫—Ç—É–µ—Ç –≤—ã—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ç–∏–ø, –µ—Å–ª–∏ –º—ã –ø—Ä–∏–º–µ–Ω–∏–º –µ–≥–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ, –ø–æ–ª—É—á–∏—Ç—Å—è_

```F#
(User -> CreditCard option) -> (User option -> CreditCard option option)
```

_–ö–∞–∫–∞—è-—Ç–æ –±–µ—Å—Å–º—ã—Å–ª–∏—Ü–∞: –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å, —Å–æ–¥–µ—Ä–∂–∞—â–µ–µ –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ, –≤ —Å–≤–æ—é –æ—á–µ—Ä–µ–¥—å, —Ç–æ–∂–µ –º–æ–∂–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞—Ç—å. –ë–æ–ª–µ–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ –º—ã –ø—Ä–æ–¥–æ–ª–∂–∏–º –ø—Ä–∏–º–µ–Ω—è—Ç—å `map`, –≤–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —Ç–∏–ø–æ–≤ `option` –±—É–¥–µ—Ç —É–≤–µ–ª–∏—á–∏–≤–∞—Ç—å—Å—è. –¢–æ, —á—Ç–æ –Ω–∞–º –Ω—É–∂–Ω–æ, —ç—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `flatMap`. –ï–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –¥–ª—è `option` —ç–ª–µ–º–µ–Ω—Ç–∞—Ä–Ω–∞, –ø—Ä–æ—Å—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ –æ–±–æ—Ä–∞—á–∏–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `f` –≤ `option`, –ø–æ—Ç–æ–º—É —á—Ç–æ –≤—ã—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∂–µ –Ω—É–∂–Ω–æ–≥–æ —Ç–∏–ø–∞._

```F#
let flatMap f x =
    match x with
    | Some y -> y |> f
    | None -> None
```

–•–æ—Ä–æ—à–æ, —Ç–µ–ø–µ—Ä—å –º—ã –º–æ–∂–µ–º –µ—â–µ –Ω–µ–º–Ω–æ–≥–æ –æ—Ç—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏—Ç—å –Ω–∞—à—É —Ñ—É–Ω–∫—Ü–∏—é `chargeUserCard`.

```F#
let chargeUserCard (amount: double) (userId: UserId): TransactionId option =
    userId
    |> lookupUser
    |> flatMap getCreditCard
    |> flatMap (chargeCard amount)
```

–¢–µ–ø–µ—Ä—å —ç—Ç–æ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ—Ö–æ–∂–µ –Ω–µ –≤–µ—Ä—Å–∏—é –±–µ–∑ —Ç–∏–ø–æ–≤ `option`. –û–¥–Ω–∞–∫–æ –¥–∞–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —à—Ç—Ä–∏—Ö –∏ –ø–µ—Ä–µ–∏–º–µ–Ω—É–µ–º `flatMap`–≤ `andThen`, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –º—ã –º–æ–∂–µ–º –¥—É–º–∞—Ç—å –æ–± —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –∫–∞–∫ –æ –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–π –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –º—ã –º–æ–∂–µ–º —Å–∫–∞–∑–∞—Ç—å: ¬´–°–¥–µ–ª–∞–π —á—Ç–æ-–Ω–∏–±—É–¥—å, –∞ –∑–∞—Ç–µ–º, –µ—Å–ª–∏ –ø–æ–ª—É—á–∏—Ç—Å—è, –∑–∞–π–º–∏—Å—å —á–µ–º-—Ç–æ –¥—Ä—É–≥–∏–º¬ª.

–ù–∞—à –∫–æ–¥ —á–∏—Ç–∞–µ—Ç—Å—è –¥–æ–≤–æ–ª—å–Ω–æ –ª–µ–≥–∫–æ –∏ —Ö–æ—Ä–æ—à–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç —Ç–æ, –∫–∞–∫ –º—ã –¥—É–º–∞–µ–º –æ —Ä–µ—à–µ–Ω–∏–∏ –ø–æ–¥–æ–±–Ω–æ–π –∑–∞–¥–∞—á–∏. –ú—ã –∏—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∑–∞—Ç–µ–º, –µ—Å–ª–∏ –æ–Ω —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –º—ã –ø–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –µ–≥–æ –∫—Ä–µ–¥–∏—Ç–Ω–æ–π –∫–∞—Ä—Ç–µ –∏, –Ω–∞–∫–æ–Ω–µ—Ü, –µ—Å–ª–∏ –∏ –æ–Ω–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –º—ã —Å–ø–∏—Å—ã–≤–∞–µ–º —Å—Ä–µ–¥—Å—Ç–≤–∞ —Å –∫–∞—Ä—Ç—ã.

## –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –æ—Ç–∫—Ä—ã–ª–∏ –º–æ–Ω–∞–¥—É

–§—É–Ω–∫—Ü–∏—è `flatMap / andThen`, –∫–æ—Ç–æ—Ä—É—é –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏, —ç—Ç–æ —Ç–æ, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è `option` –º–æ–Ω–∞–¥–æ–π. –û–±—ã—á–Ω–æ, –∫–æ–≥–¥–∞ —Ä–µ—á—å –∏–¥–µ—Ç –æ –º–æ–Ω–∞–¥–∞—Ö, —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–≤—è–∑—ã–≤–∞–Ω–∏–µ–º (`bind`), –Ω–æ —ç—Ç–æ –Ω–µ —Ç–∞–∫ –≤–∞–∂–Ω–æ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –º–æ–Ω–∞–¥. –í–∞–∂–Ω–æ —Ç–æ, —á—Ç–æ –≤—ã –≤–∏–¥–∏—Ç–µ, –ø–æ—á–µ–º—É –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, –∏ –∫–∞–∫ –æ–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç. –ü–æ —Å—É—Ç–∏ `–ú–æ–Ω–∞–¥–∞` —ç—Ç–æ –∫–ª–∞—Å—Å –≤–µ—â–µ–π —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π "then-able" —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å—é.[^1] (_—è –Ω–µ –ø–æ–¥–æ–±—Ä–∞–ª –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ–≥–æ –∫–æ—Ä–æ—Ç–∫–æ–≥–æ —Ç–µ—Ä–º–∏–Ω–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º, –∞–≤—Ç–æ—Ä –∏–º–µ–µ—Ç –≤ –≤–∏–¥—É, —á—Ç–æ –Ω–∞–¥ –º–æ–Ω–∞–¥–æ–π –º–æ–∂–Ω–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –Ω–µ–∫—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —à–∞–≥–∞. –ü–æ-—É–º–Ω–æ–º—É, –º–æ–Ω–∞–¥–∞ - —ç—Ç–æ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π. –ø—Ä–∏–º. –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞_)

## –≠–π, —è —É–∑–Ω–∞—é —Ç–µ–±—è!

–ï—Å—Ç—å –µ—â–µ –æ–¥–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞, –ø–æ—á–µ–º—É —è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–ª `flatMap` –≤ `andThen`. –ï—Å–ª–∏ –≤—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç–µ –Ω–∞ JavaScript, –≤—Å–µ —á—Ç–æ –º—ã –¥–µ–ª–∞–ª–∏, –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å—Å—è –≤–∞–º –ø–æ—Ö–æ–∂–∏–º –Ω–∞ `Promise` —Å –º–µ—Ç–æ–¥–æ–º `then`. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –≤—ã, –≤–µ—Ä–æ—è—Ç–Ω–æ, —É–∂–µ —Ä–∞–∑–æ–±—Ä–∞–ª–∏—Å—å —Å –º–æ–Ω–∞–¥–∞–º–∏. `Promise` —ç—Ç–æ —Ç–æ–∂–µ –º–æ–Ω–∞–¥–∞. –¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ —É `option`, —É –Ω–µ–≥–æ –µ—Å—Ç—å –º–µ—Ç–æ–¥ `then`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –¥—Ä—É–≥—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞ –≤—Ö–æ–¥ –∏ –≤—ã–∑—ã–≤–∞–µ—Ç –µ–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ `Promise`, –µ—Å–ª–∏ –æ–Ω –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —É—Å–ø–µ—à–Ω–æ.

## –ú–æ–Ω–∞–¥—ã ‚Äî —ç—Ç–æ –≤—Å–µ–≥–æ –ª–∏—à—å "then-able" –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

–ï—â–µ –æ–¥–∏–Ω —Ö–æ—Ä–æ—à–∏–π —Å–ø–æ—Å–æ–± –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç—å –º–æ–Ω–∞–¥—ã ‚Äî –¥—É–º–∞—Ç—å –æ –Ω–∏—Ö –∫–∞–∫ –æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö –∑–Ω–∞—á–µ–Ω–∏–π (_—Ç–∞–∫ –∂–µ –∫–∞–∫ –∏ –≤ —Å–ª—É—á–∞–µ —Å —Ñ—É–Ω–∫—Ç–æ—Ä–∞–º–∏. –ø—Ä–∏–º. –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫–∞_). `option` —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –ª–∏–±–æ —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –ª–∏–±–æ –ø—É—Å—Ç. `Promise` —ç—Ç–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π "–æ–±–µ—â–∞–µ—Ç" —Ö—Ä–∞–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–µ–∫–æ–µ–≥–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—Å—è —É—Å–ø–µ—à–Ω–æ.

–ú—ã —É–∂–µ –æ–±—Å—É–∂–¥–∞–ª–∏ –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Ç–∞–∫–∏–µ –∫–∞–∫ `List` (–∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –º–Ω–æ–≥–∏—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π) –∏ `Result` (–∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–Ω–∞—á–µ–Ω–∏–µ, –µ—Å–ª–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–∏–ª–æ—Å—å —É—Å–ø–µ—à–Ω–æ –∏–ª–∏ –æ—à–∏–±–∫—É, –µ—Å–ª–∏ –Ω–µ—Ç). –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑ —ç—Ç–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –º—ã –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `andThen`, –∫–æ—Ç–æ—Ä–∞—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é, –ø—Ä–∏–Ω–∏–º–∞—é—â—É—é –æ–±—ä–µ–∫—Ç –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞, –∫ –æ–±—ä–µ–∫—Ç—É, –∑–∞–≤–µ—Ä–Ω—É—Ç–æ–º—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä.

## –ú–æ–Ω–∞–¥—ã –≤ –¥–∏–∫–æ–π –ø—Ä–∏—Ä–æ–¥–µ

–ï—Å–ª–∏ –≤–∞–º –∫–æ–≥–¥–∞-–ª–∏–±–æ –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∫–∞–∫–∏–µ-—Ç–æ –ø—Ä–æ—Å—Ç—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–∞–∫–∏–µ –∫–∞–∫ `int`, `string` –∏–ª–∏ `User`, –∏ –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç –∫–∞–∫–æ–π-–ª–∏–±–æ –ø–æ–±–æ—á–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç, —Ç–µ–º —Å–∞–º—ã–º –≤–æ–∑–≤—Ä–∞—â–∞—è —á—Ç–æ-—Ç–æ –≤—Ä–æ–¥–µ `option`, `Promise` –∏–ª–∏ `Result`, —Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –≥–¥–µ-—Ç–æ –Ω–µ–ø–æ–¥–∞–ª–µ–∫—É —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –º–æ–Ω–∞–¥–∞. –û—Å–æ–±–µ–Ω–Ω–æ, –µ—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ç–∞–∫–∏—Ö —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ –≤—ã–∑—ã–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –≤ —Ü–µ–ø–æ—á–∫–µ.

## –ß–µ–º—É –º—ã –Ω–∞—É—á–∏–ª–∏—Å—å?

–ú—ã —É–∑–Ω–∞–ª–∏, —á—Ç–æ –ú–æ–Ω–∞–¥—ã —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–∏–ø—ã-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã —Å "then-able" —Ñ—É–Ω–∫—Ü–∏–µ–π, –∫–æ—Ç–æ—Ä–∞—è –æ–±—ã—á–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è `bind`. –ú—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é, —á—Ç–æ–±—ã —Å–æ—Å—Ç–∞–≤–∏—Ç—å —Ü–µ–ø–æ—á–∫—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –Ω–∞ –≤—Ö–æ–¥ –ø—Ä–æ—Å—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∞ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ–±–µ—Ä–Ω—É—Ç—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥—Ä—É–≥–æ–≥–æ —Ç–∏–ø–∞.

–ú–æ–Ω–∞–¥—ã –ø–æ–ª–µ–∑–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –æ—á–µ–Ω—å —à–∏—Ä–æ–∫–æ. –°—É—â–µ—Å—Ç–≤—É–µ—Ç –º–Ω–æ–≥–æ —Ç–∏–ø–æ–≤, –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –º–æ–∂–µ–º –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç —à–∞–±–ª–æ–Ω–Ω–æ–≥–æ –∫–æ–¥–∞, –æ–ø—Ä–µ–¥–µ–ª–∏–≤ —Ç–∞–∫–æ–π –º–µ—Ç–æ–¥ `bind`. –ú–æ–Ω–∞–¥–∞ - —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ –∏–º—è, –¥–∞–Ω–Ω–æ–µ —Ç–∞–∫–æ–º—É —Ç–∏–ø—É, –∞, –∫–∞–∫ —Å–∫–∞–∑–∞–ª –†–∏—á–∞—Ä–¥ –§–µ–π–Ω–º–∞–Ω, [–∏–º–µ–Ω–∞ –Ω–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—Ç –∑–Ω–∞–Ω–∏—è][1].

## –í —Å–ª–µ–¥—É—é—à–µ–π —Å–µ—Ä–∏–∏

–ï—Å–ª–∏ –≤—ã –ø–æ–º–Ω–∏—Ç–µ, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π —Ü–µ–ª—å—é, —á—Ç–æ –º—ã –ø–æ—Å—Ç–∞–≤–∏–ª–∏ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π, –∫–æ–≥–¥–∞ –Ω–∞—á–∏–Ω–∞–ª–∏ –Ω–∞—à —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, –±—ã–ª–æ –Ω–∞–ø–∏—Å–∞—Ç—å –∫–æ–¥ –ø–æ–¥–æ–±–Ω—ã–π —Ç–∞–∫–æ–º—É

```F#
let chargeUserCard (amount: double) (userId: UserId): TransactionId option =
    let user = lookupUser userId
    let creditCard = u.CreditCard
    chargeCard amount creditCard
```

–ù–æ –Ω–∞–º –≤—Å–µ –µ—â–µ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `option`. –¢–æ –µ—Å—Ç—å –º—ã –Ω–µ –¥–æ—Å—Ç–∏–≥–ª–∏ —Å–≤–æ–µ–π —Ü–µ–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é. –í —Å–ª–µ–¥—É—é—â–µ–º [–ø–æ—Å—Ç–µ][2] –º—ã —É–≤–∏–¥–∏–º, –∫–∞–∫ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `computation expressions` –≤ F#, —á—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è –±–æ–ª–µ–µ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–≥–æ —Å—Ç–∏–ª—è –¥–∞–∂–µ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –º–æ–Ω–∞–¥–∞–º–∏.

[^1]: –î–∞ –ø—Ä–æ—Å—Ç—è—Ç –º–µ–Ω—è –∑–Ω–∞—Ç–æ–∫–∏ —Ç–µ–æ—Ä–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π

[1]: https://www.youtube.com/watch?v=lFIYKmos3-s&ab_channel=CaitlinSpies

[2]:
